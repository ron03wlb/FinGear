## 一、基本面分析指標

基本面分析聚焦於公司的內在價值評估，主要從獲利能力、財務體質、成長性、估值等維度切入。

### 1.1 獲利能力指標

**毛利率 (Gross Margin)**
衡量公司產品定價能力與成本控制能力。

```
毛利率 = (營業收入 - 營業成本) / 營業收入 × 100%
```

數據來源：損益表的營業收入與營業成本

**營業利益率 (Operating Margin)**
反映本業經營效率，扣除營業費用後的獲利能力。

```
營業利益率 = 營業利益 / 營業收入 × 100%
營業利益 = 毛利 - 營業費用（銷管費用 + 研發費用）
```

**稅後淨利率 (Net Profit Margin)**
綜合反映公司最終獲利能力。

```
稅後淨利率 = 稅後淨利 / 營業收入 × 100%
```

**股東權益報酬率 ROE (Return on Equity)**
衡量股東投入資本的報酬效率，巴菲特最重視的指標之一。

```
ROE = 稅後淨利 / 平均股東權益 × 100%
平均股東權益 = (期初股東權益 + 期末股東權益) / 2
```

杜邦分析拆解：

```
ROE = 淨利率 × 資產周轉率 × 權益乘數
    = (淨利/營收) × (營收/總資產) × (總資產/股東權益)
```

**資產報酬率 ROA (Return on Assets)**
衡量公司運用全部資產創造利潤的效率。

```
ROA = 稅後淨利 / 平均總資產 × 100%
```

**投入資本報酬率 ROIC (Return on Invested Capital)**
衡量公司運用投入資本創造價值的能力，排除非營運資產影響。

```
ROIC = NOPAT / 投入資本 × 100%
NOPAT (稅後營業淨利) = 營業利益 × (1 - 有效稅率)
投入資本 = 股東權益 + 有息負債 - 現金及約當現金
```

### 1.2 財務體質指標

**流動比率 (Current Ratio)**
衡量短期償債能力。

```
流動比率 = 流動資產 / 流動負債
```

一般而言 > 1.5 為健康水準

**速動比率 (Quick Ratio)**
排除存貨後的短期償債能力，更為嚴格。

```
速動比率 = (流動資產 - 存貨 - 預付款項) / 流動負債
```

一般 > 1 為安全

**負債比率 (Debt Ratio)**
衡量財務槓桿程度。

```
負債比率 = 總負債 / 總資產 × 100%
```

**淨負債比率 (Net Debt to Equity)**
更精確反映實際負債壓力。

```
淨負債比率 = (有息負債 - 現金及約當現金) / 股東權益 × 100%
有息負債 = 短期借款 + 長期借款 + 應付公司債
```

**利息保障倍數 (Interest Coverage Ratio)**
衡量償還利息的能力。

```
利息保障倍數 = EBIT / 利息費用
EBIT = 稅前淨利 + 利息費用
```

一般 > 5 為安全

**自由現金流量 FCF (Free Cash Flow)**
公司真正可自由運用的現金。

```
FCF = 營業活動現金流量 - 資本支出
資本支出 = 購置固定資產 + 購置無形資產
```

**現金流量比率 (Cash Flow Ratio)**
衡量營運現金流對短期負債的覆蓋能力。

```
現金流量比率 = 營業活動現金流量 / 流動負債 × 100%
```

### 1.3 成長性指標

**營收年增率 (Revenue YoY Growth)**

```
營收年增率 = (本期營收 - 去年同期營收) / 去年同期營收 × 100%
```

**營收季增率 (Revenue QoQ Growth)**

```
營收季增率 = (本季營收 - 上季營收) / 上季營收 × 100%
```

**EPS 年增率 (EPS Growth)**

```
EPS年增率 = (本期EPS - 去年同期EPS) / |去年同期EPS| × 100%
```

注意：去年同期 EPS 為負數時需取絕對值

**營業利益年增率**

```
營業利益年增率 = (本期營業利益 - 去年同期營業利益) / |去年同期營業利益| × 100%
```

**複合年均成長率 CAGR (Compound Annual Growth Rate)**

```
CAGR = (終值 / 起始值)^(1/年數) - 1
```

用於計算 3 年、5 年營收或獲利的年均成長率

### 1.4 估值指標

**本益比 P/E Ratio (Price to Earnings)**

```
P/E = 股價 / 每股盈餘(EPS)
EPS = 稅後淨利 / 流通在外股數
```

預估本益比：

```
Forward P/E = 股價 / 預估未來12個月EPS
```

**股價淨值比 P/B Ratio (Price to Book)**

```
P/B = 股價 / 每股淨值
每股淨值 = 股東權益 / 流通在外股數
```

**股價營收比 P/S Ratio (Price to Sales)**
適用於尚未獲利但營收成長的公司。

```
P/S = 市值 / 營業收入
   或 = 股價 / 每股營收
```

**企業價值倍數 EV/EBITDA**
排除資本結構影響的估值指標。

```
EV = 市值 + 淨負債 + 少數股權 - 關聯企業投資
   = 市值 + 有息負債 - 現金
EBITDA = 營業利益 + 折舊 + 攤銷
EV/EBITDA = EV / EBITDA
```

**股息殖利率 (Dividend Yield)**

```
現金殖利率 = 每股現金股利 / 股價 × 100%
```

**股利發放率 (Payout Ratio)**

```
股利發放率 = 每股股利 / EPS × 100%
```

**PEG Ratio (Price/Earnings to Growth)**
結合估值與成長性的指標。

```
PEG = P/E / 預期EPS成長率(%)
```

PEG < 1 通常被視為低估

### 1.5 營運效率指標

**存貨周轉率 (Inventory Turnover)**

```
存貨周轉率 = 營業成本 / 平均存貨
存貨周轉天數 = 365 / 存貨周轉率
```

**應收帳款周轉率 (Receivable Turnover)**

```
應收帳款周轉率 = 營業收入 / 平均應收帳款
應收帳款周轉天數 = 365 / 應收帳款周轉率
```

**應付帳款周轉率 (Payable Turnover)**

```
應付帳款周轉率 = 營業成本 / 平均應付帳款
應付帳款周轉天數 = 365 / 應付帳款周轉率
```

**現金轉換週期 CCC (Cash Conversion Cycle)**

```
CCC = 存貨周轉天數 + 應收帳款周轉天數 - 應付帳款周轉天數
```

越短代表營運效率越高

---

## 二、籌碼面分析指標

籌碼面分析追蹤資金流向與各類投資人買賣行為，判斷主力動向與籌碼集中度。

### 2.1 三大法人買賣超

**外資買賣超 (Foreign Institutional Investors)**

```
外資買賣超 = 外資買進股數 - 外資賣出股數
外資買賣超金額 = 外資買進金額 - 外資賣出金額
```

**投信買賣超 (Domestic Institutional Investors)**

```
投信買賣超 = 投信買進股數 - 投信賣出股數
```

**自營商買賣超 (Dealers)**

```
自營商買賣超 = 自營商買進股數 - 自營商賣出股數
自營商自行買賣 vs 避險買賣需分開統計
```

**三大法人合計買賣超**

```
三大法人合計 = 外資買賣超 + 投信買賣超 + 自營商買賣超
```

**連續買賣超天數**

```
連續買超天數：統計法人連續淨買入的交易日數
連續賣超天數：統計法人連續淨賣出的交易日數
```

### 2.2 持股比率變化

**外資持股比率**

```
外資持股比率 = 外資持有股數 / 流通在外股數 × 100%
外資持股比率變化 = 本期持股比率 - 前期持股比率
```

**投信持股比率**

```
投信持股比率 = 投信持有股數 / 流通在外股數 × 100%
```

**董監持股比率**

```
董監持股比率 = 董監事持有股數 / 流通在外股數 × 100%
```

董監持股質押比率需另外追蹤

**大股東持股異動**
追蹤持股超過 10%的大股東申報轉讓或增持

### 2.3 融資融券指標

**融資餘額與融資使用率**

```
融資餘額 = 累計融資買進 - 累計融資償還
融資使用率 = 融資餘額 / 融資限額 × 100%
```

**融券餘額與融券使用率**

```
融券餘額 = 累計融券賣出 - 累計融券回補
融券使用率 = 融券餘額 / 融券限額 × 100%
```

**券資比 (Short Interest Ratio)**
衡量市場看空情緒。

```
券資比 = 融券餘額 / 融資餘額 × 100%
```

券資比上升代表看空力道增強

**融資維持率**

```
融資維持率 = (融資買進股票市值 / 融資金額) × 100%
```

低於 130%會收到追繳通知

**融資融券增減**

```
融資增減 = 今日融資餘額 - 昨日融資餘額
融券增減 = 今日融券餘額 - 昨日融券餘額
```

### 2.4 借券與當沖指標

**借券餘額**

```
借券餘額 = 累計借券賣出 - 累計借券回補
借券賣出占成交比 = 借券賣出張數 / 當日成交張數 × 100%
```

**當沖比率**

```
當沖比率 = 當沖成交張數 / 總成交張數 × 100%
當沖淨買賣超 = 當沖買進 - 當沖賣出
```

### 2.5 籌碼集中度指標

**大戶持股比率 (400 張以上)**

```
大戶持股比率 = 持有400張以上股東持股數 / 流通股數 × 100%
```

**散戶持股比率 (10 張以下)**

```
散戶持股比率 = 持有10張以下股東持股數 / 流通股數 × 100%
```

**股東人數變化**

```
股東人數變化率 = (本期股東人數 - 前期股東人數) / 前期股東人數 × 100%
```

股東人數減少、股價上漲代表籌碼集中

**平均每位股東持股**

```
平均持股 = 流通在外股數 / 股東人數
```

### 2.6 主力進出指標

**分點主力買賣超**
追蹤特定券商分點的買賣超狀況

```
分點買賣超 = 該分點買進張數 - 該分點賣出張數
分點進出成本 = 分點買進金額 / 分點買進張數
```

**主力買賣家數差**

```
買賣家數差 = 買進券商家數 - 賣出券商家數
```

正值代表買盤分散、賣盤集中（偏多）

**主力成本估算**

```
主力平均成本 = 主力累計買進金額 / 主力累計買進股數
```

---

## 三、技術面分析指標

技術分析透過價格與成交量的歷史數據，判斷趨勢方向、買賣時機與支撐壓力。

### 3.1 移動平均線系統

**簡單移動平均線 SMA (Simple Moving Average)**

```
SMA(n) = (P1 + P2 + ... + Pn) / n
```

其中 P 為收盤價，n 為週期
常用週期：5 日、10 日、20 日、60 日、120 日、240 日

**指數移動平均線 EMA (Exponential Moving Average)**
對近期價格賦予較高權重。

```
EMA(今日) = 今日收盤價 × α + 昨日EMA × (1 - α)
α (平滑係數) = 2 / (n + 1)
```

**加權移動平均線 WMA (Weighted Moving Average)**

```
WMA(n) = (P1×n + P2×(n-1) + ... + Pn×1) / (n + (n-1) + ... + 1)
```

**均線乖離率 (Bias)**

```
乖離率 = (收盤價 - MA) / MA × 100%
```

常用：5 日乖離、20 日乖離、60 日乖離

**均線糾結度**

```
均線糾結度 = (MAX(MA5,MA10,MA20,MA60) - MIN(MA5,MA10,MA20,MA60)) / 股價 × 100%
```

糾結度越小代表即將變盤

### 3.2 趨勢指標

**MACD (Moving Average Convergence Divergence)**

```
DIF (快線) = EMA(12) - EMA(26)
MACD (DEA/慢線) = DIF的9日EMA
柱狀體 (OSC) = DIF - MACD
```

判斷邏輯：

- DIF > MACD：多頭趨勢
- DIF 向上突破 MACD：黃金交叉，買進訊號
- DIF 向下跌破 MACD：死亡交叉，賣出訊號
- 柱狀體由負轉正：趨勢轉強

**DMI (Directional Movement Index)**

```
TR (True Range) = MAX(H-L, |H-PC|, |L-PC|)
其中 H=最高價, L=最低價, PC=前日收盤價

+DM = IF(H-PH > PL-L AND H-PH > 0, H-PH, 0)
-DM = IF(PL-L > H-PH AND PL-L > 0, PL-L, 0)
其中 PH=前日最高, PL=前日最低

+DI = EMA(+DM, 14) / EMA(TR, 14) × 100
-DI = EMA(-DM, 14) / EMA(TR, 14) × 100

ADX = EMA(|+DI - -DI| / (+DI + -DI) × 100, 14)
```

判斷邏輯：

- +DI > -DI：上漲趨勢
- ADX > 25：趨勢明確
- ADX < 20：盤整格局

**趨勢強度 ADX (Average Directional Index)**
已包含在 DMI 計算中，用於判斷趨勢強弱

### 3.3 動能指標

**RSI (Relative Strength Index)**

```
RS = 平均漲幅 / 平均跌幅
   = SMA(漲幅, n) / SMA(跌幅, n)
RSI = 100 - (100 / (1 + RS))
```

常用週期：6 日、14 日

判斷邏輯：

- RSI > 80：超買區
- RSI < 20：超賣區
- RSI 背離：價格創新高但 RSI 未創新高，看跌背離

**KD 隨機指標 (Stochastic Oscillator)**

```
RSV = (收盤價 - 最近n日最低價) / (最近n日最高價 - 最近n日最低價) × 100
K = 前日K × 2/3 + 今日RSV × 1/3  (初始值50)
D = 前日D × 2/3 + 今日K × 1/3  (初始值50)
```

常用 n = 9

判斷邏輯：

- K > 80：超買
- K < 20：超賣
- K 向上穿越 D：黃金交叉
- K 向下穿越 D：死亡交叉

**威廉指標 Williams %R**

```
%R = (最近n日最高價 - 收盤價) / (最近n日最高價 - 最近n日最低價) × (-100)
```

常用 n = 14

**動量指標 Momentum**

```
MOM = 今日收盤價 - n日前收盤價
ROC (Rate of Change) = (今日收盤價 - n日前收盤價) / n日前收盤價 × 100%
```

**CCI (Commodity Channel Index)**

```
TP (典型價格) = (最高價 + 最低價 + 收盤價) / 3
MA(TP) = TP的n日簡單移動平均
MD = TP與MA(TP)的平均絕對偏差
CCI = (TP - MA(TP)) / (0.015 × MD)
```

常用 n = 20

### 3.4 成交量指標

**成交量移動平均**

```
Volume MA(n) = (V1 + V2 + ... + Vn) / n
```

常用：5 日均量、20 日均量

**量價關係判斷**

```
價漲量增：收盤價 > 前日收盤價 AND 成交量 > 前日成交量 → 多頭確認
價漲量縮：收盤價 > 前日收盤價 AND 成交量 < 前日成交量 → 多頭疲軟
價跌量增：收盤價 < 前日收盤價 AND 成交量 > 前日成交量 → 空頭確認
價跌量縮：收盤價 < 前日收盤價 AND 成交量 < 前日成交量 → 空頭疲軟
```

**OBV (On-Balance Volume)**

```
IF 今日收盤 > 昨日收盤: OBV = 昨日OBV + 今日成交量
IF 今日收盤 < 昨日收盤: OBV = 昨日OBV - 今日成交量
IF 今日收盤 = 昨日收盤: OBV = 昨日OBV
```

**VR (Volume Ratio)**

```
VR = n日內股價上漲日成交量總和 / n日內股價下跌日成交量總和 × 100%
```

常用 n = 26

**成交量相對強度**

```
量比 = 當日成交量 / 過去n日平均成交量
```

### 3.5 波動率指標

**布林通道 Bollinger Bands**

```
中軌 = MA(20)
上軌 = MA(20) + 2 × 標準差(20)
下軌 = MA(20) - 2 × 標準差(20)
標準差 = √(Σ(Pi - MA)² / n)

帶寬 = (上軌 - 下軌) / 中軌 × 100%
%B = (收盤價 - 下軌) / (上軌 - 下軌)
```

**ATR (Average True Range)**

```
TR = MAX(H-L, |H-PC|, |L-PC|)
ATR = EMA(TR, 14) 或 SMA(TR, 14)
```

**歷史波動率 Historical Volatility**

```
日報酬率 = LN(今日收盤價 / 昨日收盤價)
波動率 = 標準差(日報酬率, n) × √252 × 100%
```

252 為年交易日數

### 3.6 支撐壓力指標

**樞軸點 Pivot Points**

```
PP (樞軸點) = (前日最高 + 前日最低 + 前日收盤) / 3
R1 (阻力1) = 2 × PP - 前日最低
S1 (支撐1) = 2 × PP - 前日最高
R2 (阻力2) = PP + (前日最高 - 前日最低)
S2 (支撐2) = PP - (前日最高 - 前日最低)
R3 (阻力3) = R1 + (前日最高 - 前日最低)
S3 (支撐3) = S1 - (前日最高 - 前日最低)
```

**費波那契回撤 Fibonacci Retracement**

```
從波段低點到高點的回撤位：
23.6% 回撤 = 高點 - (高點 - 低點) × 0.236
38.2% 回撤 = 高點 - (高點 - 低點) × 0.382
50.0% 回撤 = 高點 - (高點 - 低點) × 0.500
61.8% 回撤 = 高點 - (高點 - 低點) × 0.618
78.6% 回撤 = 高點 - (高點 - 低點) × 0.786
```

### 3.7 型態識別輔助指標

**價格通道 (Donchian Channel)**

```
上軌 = 最近n日最高價
下軌 = 最近n日最低價
中軌 = (上軌 + 下軌) / 2
```

常用 n = 20

**SAR (Stop and Reverse)**

```
SAR(今日) = SAR(昨日) + AF × (EP - SAR(昨日))
AF (加速因子)：初始0.02，每創新高/低加0.02，最大0.2
EP (極值點)：上升趨勢取最高價，下降趨勢取最低價
```

---

## 四、綜合評分模型建議

為了整合以上指標，建議設計以下評分架構：

### 4.1 基本面評分 (權重 40%)

| 類別     | 指標        | 權重 | 評分邏輯                                                                     |
| -------- | ----------- | ---- | ---------------------------------------------------------------------------- |
| 獲利能力 | ROE         | 10%  | >15%: 5 分, 10-15%: 4 分, 5-10%: 3 分, 0-5%: 2 分, <0%: 1 分                 |
| 獲利能力 | 毛利率趨勢  | 5%   | 連續 3 季上升: 5 分, 上升: 4 分, 持平: 3 分, 下降: 2 分, 連續下降: 1 分      |
| 財務體質 | 負債比率    | 5%   | <30%: 5 分, 30-50%: 4 分, 50-60%: 3 分, 60-70%: 2 分, >70%: 1 分             |
| 財務體質 | 自由現金流  | 5%   | 連續 3 年正: 5 分, 正: 4 分, 偶爾負: 3 分, 負: 2 分, 連續負: 1 分            |
| 成長性   | 營收年增率  | 5%   | >20%: 5 分, 10-20%: 4 分, 0-10%: 3 分, -10-0%: 2 分, <-10%: 1 分             |
| 成長性   | EPS 年增率  | 5%   | >20%: 5 分, 10-20%: 4 分, 0-10%: 3 分, -20-0%: 2 分, <-20%: 1 分             |
| 估值     | P/E vs 歷史 | 5%   | <歷史均值-1σ: 5 分, <均值: 4 分, 均值附近: 3 分, >均值: 2 分, >均值+1σ: 1 分 |

### 4.2 籌碼面評分 (權重 30%)

| 類別     | 指標             | 權重 | 評分邏輯                                                                      |
| -------- | ---------------- | ---- | ----------------------------------------------------------------------------- |
| 法人動向 | 外資連續買超天數 | 8%   | >10 天: 5 分, 5-10 天: 4 分, 1-5 天: 3 分, 賣超 1-5 天: 2 分, 賣超>5 天: 1 分 |
| 法人動向 | 投信連續買超天數 | 7%   | 同上                                                                          |
| 持股結構 | 外資持股變化(月) | 5%   | 增加>2%: 5 分, 增加: 4 分, 持平: 3 分, 減少: 2 分, 減少>2%: 1 分              |
| 融資券   | 券資比           | 5%   | >30%: 5 分(軋空機會), 20-30%: 4 分, 10-20%: 3 分, 5-10%: 2 分, <5%: 3 分      |
| 籌碼集中 | 大戶持股變化     | 5%   | 增加>2%: 5 分, 增加: 4 分, 持平: 3 分, 減少: 2 分, 減少>2%: 1 分              |

### 4.3 技術面評分 (權重 30%)

| 類別 | 指標         | 權重 | 評分邏輯                                                                                   |
| ---- | ------------ | ---- | ------------------------------------------------------------------------------------------ |
| 趨勢 | 股價 vs 均線 | 8%   | >MA5>MA20>MA60: 5 分(多頭排列), 部分多頭: 4 分, 糾結: 3 分, 部分空頭: 2 分, 空頭排列: 1 分 |
| 趨勢 | MACD         | 5%   | DIF>0 且向上: 5 分, DIF>0: 4 分, 零軸附近: 3 分, DIF<0: 2 分, DIF<0 且向下: 1 分           |
| 動能 | RSI(14)      | 5%   | 40-60 上升: 5 分, 60-70: 4 分, 30-40: 3 分, 70-80: 2 分(超買), <30 或>80: 1 分             |
| 動能 | KD 交叉      | 5%   | 低檔黃金交叉: 5 分, K>D: 4 分, 糾結: 3 分, K<D: 2 分, 高檔死亡交叉: 1 分                   |
| 量能 | 量價配合     | 4%   | 價漲量增: 5 分, 價漲量平: 4 分, 盤整縮量: 3 分, 價跌量增: 2 分, 無量下跌: 1 分             |
| 波動 | 布林帶位置   | 3%   | 中軌上方突破: 5 分, 中軌上方: 4 分, 中軌附近: 3 分, 中軌下方: 2 分, 下軌附近: 1 分         |

---

## 五、數據來源與 API 整合建議

### 5.1 台灣數據來源

| 數據類型 | 來源                    | 備註             |
| -------- | ----------------------- | ---------------- |
| 即時報價 | 台灣證券交易所 TWSE API | 延遲約 15 秒     |
| 三大法人 | TWSE 每日盤後資料       | 下午 3:30 後更新 |
| 融資融券 | 證交所/櫃買中心         | 盤後更新         |
| 財報數據 | 公開資訊觀測站          | 季報/年報        |
| 股東結構 | 集保中心                | 每週更新         |
| 分點進出 | 證交所                  | 需另外處理       |

### 5.2 程序實作建議

1. 建立資料庫儲存歷史數據，建議使用 PostgreSQL 或 TimescaleDB
2. 設計爬蟲模組定期抓取各來源數據
3. 建立指標計算引擎，支援批次與即時計算
4. 設計評分模組，可調整各指標權重
5. 建立回測框架驗證策略有效性
6. 開發 Dashboard 視覺化呈現

---

這份文檔涵蓋了投資分析三大面向的核心指標與計算邏輯，程序員可以據此實作完整的分析系統。如果需要，我可以進一步提供特定模組的詳細技術規格或程式碼範例。
