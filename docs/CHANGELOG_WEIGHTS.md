# 因子權重配置更新記錄

## [2026-01-03] PE 估值權重調整為 30%

### 變更摘要

將基本面篩選中的 **PE 相對估值權重從 10% 提升至 30%**，形成價值投資導向的選股策略。

### 新的權重配置

| 因子 | 舊權重 | 新權重 | 變化 |
|------|--------|--------|------|
| **PE 相對估值** | 10% | **30%** | +20% ⬆️ |
| ROE 股東權益報酬率 | 20% | 15% | -5% ⬇️ |
| EPS 年增率 | 20% | 15% | -5% ⬇️ |
| 自由現金流 (FCF) | 15% | 10% | -5% ⬇️ |
| 毛利率趨勢 | 15% | 10% | -5% ⬇️ |
| 營收年增率 | 10% | 10% | - |
| 負債比率 | 10% | 10% | - |
| **總和** | 100% | 100% | - |

### 設計理念

1. **強調估值安全邊際**：30% 的 PE 權重確保系統優先選擇低估值標的
2. **降低追高風險**：避免選入高成長但估值過高的股票
3. **價值投資導向**：結合估值 (30%) + 盈利能力 (ROE 15%) + 成長性 (EPS 15%)
4. **平衡其他因素**：現金流、毛利率、營收、負債各占 10%

### 更新的文件清單

#### 1. 配置文件
- ✅ `config/parameters.yaml` (第 6-14 行)
  - 更新 `factor_weights` 配置
  - 添加中文註釋說明

#### 2. 核心代碼
- ✅ `src/factors.py` (已支持從配置文件讀取)
  - `_load_weights()` 方法自動載入新配置
  - 備用預設權重已更新

#### 3. 文檔更新
- ✅ `CLAUDE.md` (第 24-45 行)
  - 更新三層篩選邏輯說明
  - 添加詳細的權重配置和評分門檻

- ✅ `docs/Implementation.md`
  - 第 523-531 行：更新流程圖中的權重說明
  - 第 536-567 行：**新增** 3.2.2 因子權重配置表格
  - 第 591-604 行：更新偽代碼中的加權公式

- ✅ `README.md` (第 74-87 行)
  - 更新核心功能說明
  - 添加價值投資導向描述

#### 4. 驗證工具
- ✅ `scripts/verify_factor_weights.py` (新增)
  - 驗證配置文件權重總和為 100%
  - 檢查 FactorEngine 正確載入配置
  - 運行方式：`python scripts/verify_factor_weights.py`

### 預期影響

#### 選股結果變化
1. **偏好低估值股票**：相同基本面下，PE 較低者會獲得更高分數
2. **成長股權重下降**：高成長但高估值的股票可能被篩除
3. **防禦性提升**：在市場估值偏高時，系統會更保守

#### 策略風格轉變
- **原策略**：成長與估值並重 (ROE 20% + EPS 20% + PE 10%)
- **新策略**：價值投資導向 (PE 30% + ROE 15% + EPS 15%)

### 建議後續行動

1. **回測驗證**：
   ```bash
   python scripts/backtest.py --start-date 2023-01-01 --end-date 2024-12-31
   ```
   比較新舊權重配置的選股績效

2. **實盤觀察**：
   - 觀察未來 1-2 個月的選股結果
   - 記錄 PE 分布變化
   - 追蹤實際報酬表現

3. **參數微調**（如需要）：
   - 若估值權重過高導致選股過於保守，可調整為 25%
   - 若仍有追高風險，可進一步提升至 35%

### 回滾方法

如需恢復舊配置，修改 `config/parameters.yaml`：

```yaml
factor_weights:
  roe: 0.20              # 恢復為 20%
  eps_yoy: 0.20          # 恢復為 20%
  fcf: 0.15              # 恢復為 15%
  gross_margin_trend: 0.15  # 恢復為 15%
  revenue_yoy: 0.10      # 維持 10%
  debt_ratio: 0.10       # 維持 10%
  pe_relative: 0.10      # 恢復為 10%
```

### 版本控制

- **變更日期**：2026-01-03
- **變更類型**：策略優化
- **影響範圍**：Layer 1 基本面篩選
- **向後兼容**：是（僅改變權重配置，不影響代碼結構）
- **需要重新訓練**：否（規則型策略，非機器學習）

---

**文檔維護者**：Claude Code
**最後更新**：2026-01-03
